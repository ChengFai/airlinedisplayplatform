# 1. 航班展示系统 API 接口文档



## 1.1. 接口说明

- 接口基准地址：`http://127.0.0.1:8888/api/airmana/`
- 服务端已开启 CORS 跨域支持
- 认证统一使用 Token 认证
- 需要授权的 API ，必须在请求头中使用 `Authorization` 字段提供 `token` 令牌
- 数据返回格式统一使用 JSON



## 1.2. 登录



### 1.2.1. 注册

* 请求路径：`/users/signup`

* 请求方法：post

* 请求参数

  | 参数名   | 参数说明 | 备注       |
  | -------- | -------- | ---------- |
  | username | 用户名   | 唯一       |
  | password | 密码     | bcrypt加密 |

* 响应参数

  | 参数名   | 参数说明   | 备注 |
  | -------- | ---------- | ---- |
  | username | 登录用户名 |      |

* 响应数据

  ```json
  {
    data: {
          "username": "admin2"
      },
    meta: {
      status: 1,
      msg: 注册用户成功
      }
  }
  ```

  

### 1.2.2. 登录

* 请求路径：`/users/signin`

* 请求方法：post

* 请求参数

  | 参数名   | 参数说明 | 备注 |
  | -------- | -------- | ---- |
  | username | 用户名   |      |
  | password | 密码     |      |

* 响应参数

  | 参数名   | 参数说明 | 备注 |
  | -------- | -------- | ---- |
  | username | 用户名   |      |

* 响应数据

  ```json
  {
    data: {
          "username": "admin"
      },
    meta: {
      status: 1,
      msg: 登录成功
      }
  }
  ```



### 1.2.3. 验证登录

* 请求路径：`/users/isAuth`

* 请求方法：get

* 请求参数：无

* 响应参数

  | 参数名   | 参数说明        | 备注 |
  | -------- | --------------- | ---- |
  | username | 当前登录用户名  |      |
  | iat      | token创建时间戳 |      |

  

* 响应数据

  ```json
  {
    data: {
          "username": "admin",
          "iat": 1613569899
      },
    meta: {
      status: 1,
      msg: 用户已登录
      }
  }
  ```



## 1.3. 机场管理



### 1.3.1. 获取全部机场

* 请求路径：`/airports/`

* 请求方法：get

* 请求参数

  | 参数名 | 参数说明 | 备注 |
  | ------ | -------- | ---- |
  |        |          |      |
  |        |          |      |
  |        |          |      |

* 响应参数

  | 参数名 | 参数说明           | 备注 |
  | ------ | ------------------ | ---- |
  | name   | 机场名             |      |
  | coord  | 机场坐标，包含x、y |      |

* 响应数据

  ```json
  {
    data: [
      {
              "coord": {
                  "x": "94.794533",
                  "y": "36.4067"
              },
              "_id": "602b7970ff494957b81148f2",
              "name": "格尔木机场"
          }
    ],
    meta: {
      status: 1,
      msg: "成功获取全部机场列表"
    }
  }
  ```



### 1.3.2. 获取特定机场位置

* 请求路径：`/airports/`

* 请求方法：post

* 请求参数

  | 参数名 | 参数说明   | 备注 |
  | ------ | ---------- | ---- |
  | from   | 出发机场名 |      |
  | to     | 抵达机场名 | 可选 |

* 响应参数

  | 参数名 | 参数说明                             | 备注 |
  | ------ | ------------------------------------ | ---- |
  | coords | 包含所有的坐标结果（0:出发，1:抵达） |      |

* 响应数据

  ```json
  {
    data: {
      "coords": [
              {
                  "x": "94.794533",
                  "y": "36.4067"
              },
        			{
                	"x": "94.794533",
                  "y": "36.4067"
              }
          ]
    },
    meta: {
      status: 1,
      msg: "获取到数据 * 2"
    }
  }
  ```



## 1.4. 航班管理



### 1.4.1. 根据出发地获取航班列表

* 请求路径：`/airlines/findbyfrom`

* 请求方法：post

* 请求参数

  | 参数名 | 参数说明 | 备注 |
  | ------ | -------- | ---- |
  | from   | 出发地名 |      |

* 响应参数

  | 参数名        | 参数说明     | 备注 |
  | ------------- | ------------ | ---- |
  | date          | 航班周计划表 |      |
  | numb          | 航班号       |      |
  | type          | 机型         |      |
  | startTime     | 起飞时间     |      |
  | startAirports | 起飞机场     |      |
  | endTime       | 抵达时间     |      |
  | endAirports   | 抵达机场     |      |
  | ontimeRate    | 准时率       |      |
  | from          | 出发地       |      |
  | to            | 抵达地       |      |

* 响应数据

  ```json
  {
    data: [
      {
              "date": [1,1,1,1,1,1,1],
              "_id": "602b795dff494957b811478a",
              "numb": "MF7087",
              "type": "机型:190",
              "startTime": "07:40",
              "startAirport": "正定国际机场",
              "endTime": "12:50",
              "endAirport": "北海福成机场",
              "ontimeRate": "97%",
              "from": "石家庄",
              "to": "北海"
          }
    ],
    meta: {
      status: 1,
      msg: "获取到从石家庄出发的所有航班"
    }
  }
  ```



### 1.4.1. 根据抵达地获取航班列表

* 请求路径：`/airlines/findbyto`

* 请求方法：post

* 请求参数

  | 参数名 | 参数说明 | 备注 |
  | ------ | -------- | ---- |
  | to     | 抵达地名 |      |

* 响应参数

  | 参数名        | 参数说明     | 备注 |
  | ------------- | ------------ | ---- |
  | date          | 航班周计划表 |      |
  | numb          | 航班号       |      |
  | type          | 机型         |      |
  | startTime     | 起飞时间     |      |
  | startAirports | 起飞机场     |      |
  | endTime       | 抵达时间     |      |
  | endAirports   | 抵达机场     |      |
  | ontimeRate    | 准时率       |      |
  | from          | 出发地       |      |
  | to            | 抵达地       |      |

* 响应数据

  ```json
  {
    data: [
      {
              "date": [1,1,1,1,1,1,1],
              "_id": "602b795dff494957b8113d7e",
              "numb": "CZ9938",
              "type": "机型:738",
              "startTime": "11:05",
              "startAirport": "虹桥国际机场",
              "endTime": "13:10",
              "endAirport": "正定国际机场",
              "ontimeRate": "87%",
              "from": "上海",
              "to": "石家庄"
          }
    ],
    meta: {
      status: 1,
      msg: "获取到抵达石家庄的所有航班"
    }
  }
  ```



